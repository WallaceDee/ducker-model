!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash/mapValues"),require("lodash/set"),require("lodash/get"),require("lodash/isNumber"),require("lodash/isString"),require("lodash/isArray"),require("lodash/isDate"),require("lodash/isBoolean"),require("manba")):"function"==typeof define&&define.amd?define(["lodash/mapValues","lodash/set","lodash/get","lodash/isNumber","lodash/isString","lodash/isArray","lodash/isDate","lodash/isBoolean","manba"],t):(e=e||self,e.ducker=t(e._mapValues,e._set,e._get2,e._isNumber,e._isString,e._isArray,e._isDate,e._isBoolean,e._manba))}(this,function(e,t,r,a,n,u,o,i,s){"use strict";function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r,a=a&&a.hasOwnProperty("default")?a.default:a,n=n&&n.hasOwnProperty("default")?n.default:n,u=u&&u.hasOwnProperty("default")?u.default:u,o=o&&o.hasOwnProperty("default")?o.default:o,i=i&&i.hasOwnProperty("default")?i.default:i,s=s&&s.hasOwnProperty("default")?s.default:s;var y={S:10,B:100,Q:1e3,w:1e4};return function(){function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,f),this._attributes=h({},e)}return c(f,[{key:"parse",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(this._attributes,function(e,a){var n=e.property,u=new e.type,o=e.format,i=e.computed,s=e.unit,l=t._get({data:r,path:n,computed:i});l&&(l=t.compose({distValue:l,type:u,unit:s,format:o,computed:i}));var f=l||t.getDefaultValue(e.value,e.type);t.set(a,f)}),this}},{key:"traverse",value:function(){var r=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!a)return this;var n={};return e(this._attributes,function(e,u){var o=e.property,i=e.unit,s=new e.type,l=(e.format,a[u]);if(l){var f=r.discompose({sourceValue:l,unit:i,key:u,type:s});t(n,o,f)}}),n}},{key:"compose",value:function(e){var t=e.distValue,r=e.type,a=e.unit,n=e.format,u=void 0===n?"l":n,i=e.computed;return a&&(t=Number.parseFloat(t/y[a]).toFixed(2)),o(r)&&(t=s(parseFloat(t)).format(u)),i&&(t=i(t)),t}},{key:"discompose",value:function(e){var t=e.sourceValue,r=e.unit,a=e.key,n=e.type;return o(n)&&(t=s(t).time()),r&&(t*=y[r]),t||this.get(a)}},{key:"set",value:function(e,t){this[e]=t}},{key:"get",value:function(e,t){return this[e]}},{key:"_get",value:function(e){var t=e.data,a=e.path,n=e.computed;if(u(a)&&!n)return void console.error("path定义为数组路径，computed属性必须定义");if(u(a)&&n){var o=[];return a.forEach(function(e,a){o.push(r(t,e))}),o}return u(a)?void 0:r(t,a)}},{key:"getDefaultValue",value:function(e,t){return e||this.setDefaultValue(t)}},{key:"setDefaultValue",value:function(e){var t="",r=new e;return a(r)?t=0:n(r)?t="":u(r)?t=[]:i(r)?t=!0:o(r)&&(t=Date.now()),t}}]),f}()});
